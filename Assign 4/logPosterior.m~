function logP = logPosterior(theta,X,Y)

sigma_f=theta(1);sigma_l=theta(2);sigma_n=theta(3);

m=length(X);

Xii = repmat(X.*X,1,m);
Xjj=Xii';

XXi_XXj = Xii+Xjj-2*X*X';


Kp = exp(sigma_f)*exp(-0.5*exp(sigma_l)*XXi_XXj);
% Kp=XXi_XXj;
L = chol(Kp);
c1
beta = solve(L',);

logP = -0.5*Y'*beta-sum(log(diag(L))) - size(X,1)/2*log(2*pi);

end